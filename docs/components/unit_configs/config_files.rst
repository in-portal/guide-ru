Конфигурационные файлы
======================
`Data Source`_
`Eng Data Source`_

.. include:: /includes/not_finished.rst

**Unit config** - это файл в котором находится информация об **одной** таблице в базе данных и параметры,
связанные с отображением и изменением данных в ней содержащихся. Файл из себя представляет ассоциативный
массив в котором каждый ключ является отдельной опцией (сам массив находиться в переменной ``$config``).
Значение каждой опции может быть любого,
`доступного в php <https://www.php.net/language.types>`__, типа. Опции могут быть взаимосвязаны между собой,
однако их связь не возможно проследить анализируя только сам файл с unit config. Это лучше всего делать
выполнив поиск названий этих опций в php коде K4.

Все стандартные опции
---------------------

+--------------------------------------+---------------------------------------------------------------------------------------+
| название опции                       | описание опции                                                                        |
+======================================+=======================================================================================+
| .. config-property::                 | Префикс этого unit config (должен быть уникальным среди всех unit configs).           |
|    :name: Prefix                     | Содержание данной опции должно соответствовать правилу                                |
|    :type: string                     | :doc:`назначения имён </addons/coding_standards/naming_conventions>`.                 |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Регистрирует в системе связку между :ref:`префиксом <uc_Prefix>` и классом, для       |
|    :name: ItemClass                  | работы с одной записью в базе.                                                        |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |class_registration_usage|           |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Регистрирует в системе связку между :ref:`префиксом <uc_Prefix>` и классом для        |
|    :name: ListClass                  | отображения содержания таблицы из базы                                                |
|    :type: array                      | (фильтрация, per-page и т.п.).                                                        |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |class_registration_usage|           |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Регистрирует в системе связку между :ref:`префиксом <uc_Prefix>` и классом для        |
|    :name: EventHandlerClass          | обработки стандартных событий из grid и форм                                          |
|    :type: array                      | редактирования.                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |class_registration_usage|           |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Регистрирует в системе связку между :ref:`префиксом <uc_Prefix>` и классом для        |
|    :name: TagProcessorClass          | обработки стандартных тэгов, использующихся для вывода информации.                    |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |class_registration_usage|           |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Регистрирует в системе любые пользовательские классы.                                 |
|    :name: RegisterClasses            |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |class_registration_usage|           |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Обеспечивает автоматическую загрузку (load) ``item`` объекта по ID, найденному        |
|    :name: AutoLoad                   | в ``$_REQUEST``.                                                                      |
|    :type: boolean                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | .. versionadded:: 5.0.0                                                               |
|    :name: CheckSimulatniousEdit      |                                                                                       |
|    :type: boolean                    | Указывает на то, что для таблицы, указанной в данном конфигурационном файле должна    |
|    :ref_prefix: uc_                  | производиться проверка на двойное редактирование записей. Данная проверка работает    |
|                                      | следующим образом: если один пользователь открывает на редактирование запись,         |
|                                      | которую уже редактирует другой пользователь, то первому пользователю будет            |
|                                      | показано предупреждение о том, что открытую им запись уже редактирует другой          |
|                                      | пользователь. В предупреждении будет указано имя пользователя и его IP-адрес.         |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: QueryString                |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Выполняет указанные события с требуемым интервалом.                                   |
|    :name: RegularEvents              |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |regular_events_usage|               |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Влияет на то, как переменные данного префикса будут выглядеть в |env_link|            |
|    :name: PortalStyleEnv             | Если задать в ``true``, то не будет дефиса между префиксом и значением его первой     |
|    :type: boolean                    | переменной, т.е. будет ``m5``, вместо ``m-5`` как обычно.                             |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: CatalogItem                |                                                                                       |
|    :type: boolean                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: AdminTemplatePath          |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: AdminTemplatePrefix        |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: SearchConfigPostfix        |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ConfigPriority             |                                                                                       |
|    :type: integer                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | .. versionadded:: 5.0.0                                                               |
|    :name: PassPriority               |                                                                                       |
|    :type: integer                    | Позволяет указать порядок, в котором данный префикс будет показываться среди          |
|    :ref_prefix: uc_                  | остальных префиксов при построении значения |env_link|.                               |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Позволяет добавлять новые hooks в систему.                                            |
|    :name: Hooks                      |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |hooks_usage|                        |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ItemType                   |                                                                                       |
|    :type: integer                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ViewMenuPhrase             |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ItemPropertyMappings       |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: TitlePhrase                |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Название колонки в таблице, содержащей первичный ключ (primary key). Обычно           |
|    :name: IDField                    | это числовая колонка с опцией autoincrement.                                          |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Список колонок в таблице (обычно одна, напр. ``Array ('Status')`` или                 |
|    :name: StatusField                | ``Array ('Enabled')``), которые влияют на пиктограмму в каждой строке                 |
|    :type: array                      | grid в In-Portal. Так же значение этой опции используется в событиях                  |
|    :ref_prefix: uc_                  | :doc:`/events/lists/on_mass_approve` и :doc:`/events/lists/on_mass_decline`.          |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Название поля, использующегося в событиях :doc:`/events/lists/on_mass_move_up` и      |
|    :name: OrderField                 | :doc:`/events/lists/on_mass_move_down` для изменения порядка отображения записей      |
|    :type: string                     | в списке. Если опция не задана, то её значение будет равно ``Priority``.              |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Название колонки в таблице, содержание которой будет использовано в заголовке         |
|    :name: TitleField                 | формы редактирования этого item. Используется в опции :ref:`uc_TitlePresets`.         |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Название таблицы в базе данных для которой будет использоваться данный unit           |
|    :name: TableName                  | config, напр. ``TABLE_PREFIX.'Tests'``.                                               |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: SubItems                   |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Набор заголовков над grid и формами редактирования (текст на синем фоне),             |
|    :name: TitlePresets               | напр. "**Editing Order 000554-002 - General**", "**Orders (5 of 17)**".               |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: EditTabPresets             |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: PermItemPrefix             |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: PermTabText                |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Название |sections1_sub| (в дереве секций в левом frame), которая отвечает за         |
|    :name: PermSection                | проверку прав доступа к этому unit config, напр. ``Array('main' => 'custom:tests')``. |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Набор |sections2_sub| в дереве из левого frame в административной консоли.            |
|    :name: Sections                   |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |sections_usage|                     |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: FilterMenu                 |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Указывает на то, должны ли сохраняться значения                                       |
|    :name: PopulateMlFields           | :ref:`переводимых полей <fmt_class_kMultiLanguage>` (напр. пришедших с                |
|    :type: boolean                    | формы) на языках, отличных от текущего.                                               |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ListSQLs                   |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ListSortings               |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ItemSQLs                   |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Вычисляемые поля в grid/item.                                                         |
|    :name: CalculatedFields           |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | Описание полей из :ref:`таблицы <uc_TableName>` в базе данных                         |
|    :name: Fields                     | (тип данных, :doc:`форматер </components/unit_configs/formatters>` и т. п.).          |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |fields_usage|                       |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 | По структуре это такой же массив, как и в опции :ref:`uc_Fields`. Единственное        |
|    :name: VirtualFields              | отличие в том, что значения этих полей не будут сохранены в базе данных.              |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
|                                      |                                                                                       |
| |fields_usage|                       |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: Grids                      |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ConfigMapping              |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: AggregatedCalculatedFields |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: AutoClone                  |                                                                                       |
|    :type: boolean                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: AutoDelete                 |                                                                                       |
|    :type: boolean                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: CacheModRewrite            |                                                                                       |
|    :type: boolean                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: CatalogTabIcon             |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: Clones                     |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: Constrain                  |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: CustomFields               |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: FileCount                  |                                                                                       |
|    :type: integer                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ForceDontLogChanges        |                                                                                       |
|    :type: boolean                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ForeignKey                 |                                                                                       |
|    :type: string/array               |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ImageCount                 |                                                                                       |
|    :type: integer                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ImportKeys                 |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: LogChanges                 |                                                                                       |
|    :type: boolean                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ModuleFolder               |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: OwnerField                 |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ParentPrefix               |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: ParentTableKey             |                                                                                       |
|    :type: string/array               |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: RewritePriority            |                                                                                       |
|    :type: float                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: SectionAdjustments         |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: SectionPrefix              |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: SiteConfigProcessed        |                                                                                       |
|    :type: boolean                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: StatisticsInfo             |                                                                                       |
|    :type: array                      |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: UsePendingEditing          |                                                                                       |
|    :type: boolean                    |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+
| .. config-property::                 |                                                                                       |
|    :name: DownloadHelperClass        |                                                                                       |
|    :type: string                     |                                                                                       |
|    :ref_prefix: uc_                  |                                                                                       |
+--------------------------------------+---------------------------------------------------------------------------------------+

.. |sections1_sub| replace:: :doc:`секции </admin_console_ui/templates_and_blocks/tree_sections>`
.. |sections2_sub| replace:: :doc:`секций </admin_console_ui/templates_and_blocks/tree_sections>`
.. |env_link| replace:: :doc:`переменной окружения </application_structure/environment_variable>`

.. |class_registration_usage| replace:: (:doc:`использование </components/unit_configs/class_registration>`)
.. |regular_events_usage| replace:: (:doc:`использование </components/unit_configs/regular_events>`)
.. |hooks_usage| replace:: (:doc:`использование </components/unit_configs/hooks>`)
.. |sections_usage| replace:: (:doc:`использование </admin_console_ui/templates_and_blocks/tree_sections>`)
.. |fields_usage| replace:: (:doc:`использование </components/unit_configs/table_field_description>`)

.. _Data Source: http://guide.in-portal.org/rus/index.php/K4:%D0%9A%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D0%B5_%D1%84%D0%B0%D0%B9%D0%BB%D1%8B
.. _Eng Data Source: http://guide.in-portal.org/eng/index.php/K4:Unit_Configuration_File

